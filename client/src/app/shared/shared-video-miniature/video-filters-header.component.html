<div class="root" [formGroup]="form">

  <div class="first-row">
    <div>
      <div class="d-flex flex-wrap me-2">
        @for (quickFilter of quickFilters; track quickFilter) {
          <my-button
            theme="secondary" [icon]="quickFilter.iconName" class="me-2 mb-2"
            ptRouterLink="." [ptQueryParams]="quickFilter.queryParams" [active]="quickFilter.isActive()" ptQueryParamsHandling="merge"
            >{{ quickFilter.label }} </my-button>
        }
      </div>

      <div class="filters-summary d-inline-block">
        <div class="d-inline-block active-filters">
          @for (filter of filters.getActiveFilters(); track filter.key + (filter.value || '')) {
            <div class="d-inline-block">
              <span i18n *ngIf="filter.value">{{ filter.label }}: </span>
              <strong>{{ getFilterValue(filter) || filter.label }}</strong>
            </div>
          }
        </div>

        <button
          class="filters-toggle peertube-button-like-link" (click)="areFiltersCollapsed = !areFiltersCollapsed"
          [attr.aria-expanded]="!areFiltersCollapsed" aria-controls="collapseBasic"
          [ngClass]="{ active: !areFiltersCollapsed }"
        >
          @if (areFiltersCollapsed) {
            <ng-container i18n>More filters</ng-container>
          } @else {
            <ng-container i18n>Hide filters</ng-container>
          }

          <my-global-icon iconName="chevrons-up"></my-global-icon>
        </button>
      </div>
    </div>

    <div class="d-flex flex-wrap align-items-center ms-3" *ngIf="!hideScope">
      <label for="scope" i18n class="select-label">Display videos of:</label>

      <my-select-options inputId="scope" class="scope-select" formControlName="scope" [items]="availableScopes"></my-select-options>
    </div>
  </div>

  <div [ngbCollapse]="areFiltersCollapsed" [animation]="true">
    <div class="filters">
      <div class="section">
        <div class="section-title" i18n>Display order</div>

        <div class="form-group">
          <label for="sort-videos" i18n class="select-label">Sort by:</label>

          <my-select-options inputId="sort-videos" class="d-inline-block me-2" formControlName="sort" [items]="sortItems"></my-select-options>
        </div>
      </div>

      <div class="section">
        <div class="section-title">
          <ng-container i18n>Content preferences</ng-container>

          <div class="with-description">
            <ng-container i18n>You always use the same preferences?</ng-container>

            <ng-container i18n>
              Update your <a routerLink="/my-account/settings" fragment="video-languages-subtitles" (click)="onAccountSettingsClick($event)">default settings</a>
            </ng-container>
          </div>
        </div>

        <div class="form-group">
          <label for="languageOneOf" i18n>Languages</label>

          <my-select-languages inputId="languageOneOf" [maxLanguages]="20" formControlName="languageOneOf"></my-select-languages>
        </div>

        <div class="form-group" role="radiogroup">
          <label for="nsfw" i18n>Sensitive content</label>

          <div class="peertube-radio-container">
            <input formControlName="nsfw" type="radio" name="nsfw" id="nsfwBoth" value="both" />
            <label for="nsfwBoth">{{ filters.getNSFWDisplayLabel() }}</label>
          </div>

          <div class="peertube-radio-container">
            <input formControlName="nsfw" type="radio" name="nsfw" id="nsfwFalse" value="false" />
            <label for="nsfwFalse" i18n>Hide</label>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title" i18n>Content type</div>

        <div class="form-group">
          <label for="categoryOneOf" i18n>Categories</label>

          <my-select-categories inputId="categoryOneOf" formControlName="categoryOneOf"></my-select-categories>
        </div>

        <div class="form-group" role="radiogroup">
          <label for="type" i18n>Type</label>

          <div class="peertube-radio-container">
            <input formControlName="live" type="radio" name="live" id="liveBoth" value="both" />
            <label for="liveBoth" i18n>VOD & Live videos</label>
          </div>

          <div class="peertube-radio-container">
            <input formControlName="live" type="radio" name="live" id="liveTrue" value="true" />
            <label for="liveTrue" i18n>Live videos</label>
          </div>

          <div class="peertube-radio-container">
            <input formControlName="live" type="radio" name="live" id="liveFalse" value="false" />
            <label for="liveFalse" i18n>VOD videos</label>
          </div>
        </div>
      </div>

      <div class="section" *ngIf="canSeeAllVideos()">
        <div class="section-title" i18n>Moderation</div>

        <div class="form-group">
          <my-peertube-checkbox
            formControlName="allVideos"
            inputName="allVideos"
            i18n-labelText labelText="Display all videos (private, unlisted, password protected or not yet published)"
          ></my-peertube-checkbox>
        </div>
      </div>
    </div>
  </div>

</div>
